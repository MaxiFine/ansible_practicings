Vagrant.configure("2") do |config|
  # VM 1: Web Server
  config.vm.define "web" do |web|
    web.vm.box = "ubuntu/focal64" # Use Ubuntu 20.04 for the web server
    web.vm.hostname = "web"
    
    # Public network configuration for the web server
    web.vm.network "public_network", ip: "172.23.250.46" # Static IP for public access
    
    # Provisioning script for the web server
    web.vm.provision "shell", inline: <<-SHELL
      sudo apt-get update
      sudo apt-get install -y apache2 # Example: Install Apache web server
    SHELL
  end

  # VM 2: Database Server
  config.vm.define "database" do |db|
    db.vm.box = "ubuntu/focal64" # Use Ubuntu 20.04 for the database server
    db.vm.hostname = "database"
    
    # Public network configuration for the database server
    db.vm.network "public_network", ip: "172.23.250.47" # Static IP for public access
    
    # Provisioning script for the database server
    db.vm.provision "shell", inline: <<-SHELL
      sudo apt-get update
      sudo apt-get install -y mysql-server # Example: Install MySQL database
    SHELL
  end

  # Provider settings for both VMs
  config.vm.provider "virtualbox" do |vb|
    vb.memory = "1024" # Allocate 1GB of RAM for each VM
    vb.cpus = 2        # Allocate 2 CPUs for each VM
    config.vm.network "forwarded_port", guest: 80, host: 8080,  auto_correct: true # Forward port 80 to 8080 for web server
    config.vm.usable_port_range = (8000..9000) # Define port range for SSH access
  end
end
